%MATLAB program to implement a partitioned control law for the Microbot manipulator that will track
the trajectory: ùúÉ1(t)= ùúÉ2(t)= ùúÉ3(t)= 45[1 + 6e^-t/0.3 ‚Äì 8e^-t/0.4], 0 ‚â§ t ‚â§ 2 s. Plot the torques and the desired and actual
joint positions, velocities and accelerations against time.

clc
clear all
close all
syms atdot atheta theta1 theta2 theta3 tdot1 tdot2 tdot3 tddot1 tddot2 tddot3 t
atd_1 = 0;atd_2 = 0;atd_3 = 0;at_1 = 0;at_2 = 0;at_3 = 0; z = 0:0.05:2;

%Obtained from inverse dynamics
Torque1 = sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)^2*(32*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 + (pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) - (392*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/5 + 32*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 - (pi*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) + (3*pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/2 + 6*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3) + (243388915243820059990639815496725*pi^2*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/162259276829213363391578010288128 + 4*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2 + (162259276829213368359335610309639*pi^2*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/20282409603651670423947251286016) - (16524327490667539036901295542150738761909780466889*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/13164036458569648337239753460458804039861886925068638906788872192 - cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(24*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 + (pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) - (588*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/5 + 24*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 - (pi*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) + cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(32*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 + (pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) - (392*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/5 + 32*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*((pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/16 - (pi*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/4) + (3*pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/2 + 6*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3) + (243388915243820059990639815496725*pi^2*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/162259276829213363391578010288128 + 4*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2 + (162259276829213368359335610309639*pi^2*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/20282409603651670423947251286016) + (9*pi^2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2)/4 + 9*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3) + (730166745731460179971919446490175*pi^2*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/324518553658426726783156020576256 + 3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))^2 + (486777830487640105078006830928917*pi^2*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/81129638414606681695789005144064) - (4967757600021511*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16))/10141204801825835211973625643008 + (4967757600021511*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16))/10141204801825835211973625643008 - (14903272800064533*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + 2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + 2*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*((pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)^2*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/4 - (pi*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)^2*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/4) + (26328072917139298286609018205555527386232636944904737985456310321*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/13164036458569648337239753460458804039861886925068638906788872192))/81129638414606681695789005144064 + (3627756489168007981517746420298787*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/16455045573212060421549691825573505049827358656335798633486090240 - (14903272800064533*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + (162259276829213368359335610309639*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/40564819207303340847894502572032 - 2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) - pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3))))/81129638414606681695789005144064 - (730260367203162117*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/202824096036516704239472512860160 + (44709818400193599*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/649037107316853453566312041152512 + (4967757600021511*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/20282409603651670423947251286016;
T1final=vpa(subs(T1,t,f));
Torque1_ans=vpa(subs(Torque1,t,z));

Torque2 = 8*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) - (3326315174998874073721289211444399*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/162259276829213363391578010288128 - 8*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) - 3*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + 2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + 2*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*((pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)^2*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/4 - (pi*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)^2*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/4) + (26328072917139298286609018205555527386232636944904737985456310321*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/13164036458569648337239753460458804039861886925068638906788872192) + (730260367203162117*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/202824096036516704239472512860160 - 3*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*(2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + (162259276829213368359335610309639*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/40564819207303340847894502572032 - 2*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) - pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3))) - (294*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 + (9*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/8 + 4*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3));     
T2final=vpa(subs(T2,t,f));
Torque2_ans=vpa(subs(Torque2,t,z));

Torque3 = 8*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((19746054687854474924053897117645122037479483886978449819495241875*pi^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/105312291668557186697918027683670432318895095400549111254310977536 - (795070456463145529302756730622635*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4))/81129638414606681695789005144064 + (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) - (162259276829213368359335610309639*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/10141204801825835211973625643008 - 8*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*((243388915243820059990639815496725*pi*(50*exp(-(5*t)/2) - (200*exp(-(10*t)/3))/3))/324518553658426726783156020576256 - (243420122401054039*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/405648192073033408478945025720320 + (49*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2)/5 - (3*pi^2*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)))/16) + 4*pi*cos((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*sin((pi*(6*exp(-(10*t)/3) - 8*exp(-(5*t)/2) + 1))/4)*(pi*cos((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)) - pi*sin((pi*(6*exp(-(10*conj(t))/3) - 8*exp(-(5*conj(t))/2) + 1))/4)^2*(20*exp(-(5*conj(t))/2) - 20*exp(-(10*conj(t))/3)))*(20*exp(-(5*t)/2) - 20*exp(-(10*t)/3)); 
T3final=vpa(subs(T3,t,f));
Torque3_ans=vpa(subs(Torque3,t,z));

%Given position
Th_1 = deg2rad(45)*(1+6*exp(-t/0.3)-8*exp(-t/0.4));
Th_2 = deg2rad(45)*(1+6*exp(-t/0.3)-8*exp(-t/0.4));
Th_3 = deg2rad(45)*(1+6*exp(-t/0.3)-8*exp(-t/0.4));
TH = [Th_1,Th_2,Th_3];

%Given velocity
Thd_1 = gradient(Th_1);
Thd_2 = gradient(Th_2);
Thd_3 = gradient(Th_3);
THD = [Thd_1,Thd_2,Thd_3];

%Given acceleration
Thdd_1 = gradient(Thd_1);
Thdd_2 = gradient(Thd_2);
Thdd_3 = gradient(Thd_3);
THDD = [Thdd_1,Thdd_2,Thdd_3];
Atheta_output = [at_1,at_2,at_3];
Atdot_output = [atd_1,atd_2,atd_3];

%Gain
kp = 0.1;
kv = 2*(kp^(0.5));

%Taken from forward dynamics

V_block = [ (14903272800064533*cos(conj(theta3))*(2*sin(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 2*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 6*tdot1*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1)*sin(theta2)))/81129638414606681695789005144064 - (14903272800064533*sin(conj(theta3))*(2*cos(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 2*(tdot1*cos(theta2)*cos(theta3) - tdot1*sin(theta2)*sin(theta3))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 2*((4967757600021511*conj(tdot1))/20282409603651670423947251286016 + 4*conj(tdot2) + 4*conj(tdot3))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2 + tdot3) - 6*tdot1*cos(conj(theta2))*sin(conj(theta3))*conj(tdot1)*sin(theta2)))/81129638414606681695789005144064 - cos(theta2)*(24*conj(tdot3)*(cos(conj(theta2))*sin(conj(theta3))*conj(tdot1) + cos(conj(theta3))*sin(conj(theta2))*conj(tdot1)) + 6*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*((4967757600021511*conj(tdot1))/20282409603651670423947251286016 + 4*conj(tdot2) + 4*conj(tdot3)) + cos(theta3)*(32*conj(tdot3)*(cos(conj(theta2))*sin(conj(theta3))*conj(tdot1) + cos(conj(theta3))*sin(conj(theta2))*conj(tdot1)) + 8*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*((4967757600021511*conj(tdot1))/20282409603651670423947251286016 + 4*conj(tdot2) + 4*conj(tdot3)) + 8*tdot1*sin(theta2)*((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2)) + 24*sin(conj(theta2))*conj(tdot1)*conj(tdot2) + 32*cos(conj(theta2))*conj(tdot1)*conj(tdot2)*sin(theta3) + 32*sin(conj(theta2))*conj(tdot1)*conj(tdot2)*cos(theta3)) + 12*tdot1*sin(theta2)*((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2)) + 36*sin(conj(theta2))*conj(tdot1)*conj(tdot2) + 24*cos(conj(theta2))*conj(tdot1)*conj(tdot2)*sin(theta3) + 24*sin(conj(theta2))*conj(tdot1)*conj(tdot2)*cos(theta3)) + (4967757600021511*sin(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)))/10141204801825835211973625643008 + (4967757600021511*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)))/10141204801825835211973625643008 + sin(theta2)*sin(theta3)*(32*conj(tdot3)*(cos(conj(theta2))*sin(conj(theta3))*conj(tdot1) + cos(conj(theta3))*sin(conj(theta2))*conj(tdot1)) + 8*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*((4967757600021511*conj(tdot1))/20282409603651670423947251286016 + 4*conj(tdot2) + 4*conj(tdot3)) + 8*tdot1*sin(theta2)*((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2)) + 24*sin(conj(theta2))*conj(tdot1)*conj(tdot2) + 32*cos(conj(theta2))*conj(tdot1)*conj(tdot2)*sin(theta3) + 32*sin(conj(theta2))*conj(tdot1)*conj(tdot2)*cos(theta3)) + (44709818400193599*tdot1*cos(conj(theta2))*conj(tdot1)*sin(theta2))/40564819207303340847894502572032 + (14903272800064533*tdot1*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1)*sin(theta2))/10141204801825835211973625643008,
3*cos(conj(theta3))*(2*sin(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 2*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 6*tdot1*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1)*sin(theta2)) - 3*sin(conj(theta3))*(2*cos(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 2*(tdot1*cos(theta2)*cos(theta3) - tdot1*sin(theta2)*sin(theta3))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 2*((4967757600021511*conj(tdot1))/20282409603651670423947251286016 + 4*conj(tdot2) + 4*conj(tdot3))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2 + tdot3) - 6*tdot1*cos(conj(theta2))*sin(conj(theta3))*conj(tdot1)*sin(theta2)) + 8*sin(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 8*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 18*tdot1*cos(conj(theta2))*conj(tdot1)*sin(theta2) + 24*tdot1*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1)*sin(theta2), 8*sin(conj(theta3))*(((14903272800064533*conj(tdot1))/81129638414606681695789005144064 + 3*conj(tdot2))*((4967757600021511*tdot1)/81129638414606681695789005144064 + tdot2) + 3*tdot1*cos(conj(theta2))*conj(tdot1)*cos(theta2)) + 8*(tdot1*cos(theta2)*sin(theta3) + tdot1*cos(theta3)*sin(theta2))*(4*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1) - 4*sin(conj(theta2))*sin(conj(theta3))*conj(tdot1)) + 24*tdot1*cos(conj(theta2))*cos(conj(theta3))*conj(tdot1)*sin(theta2)];

Vblock_t=subs(V_block,[theta1,theta2,theta3,tdot1,tdot2,tdot3],[at_1,at_2,at_3,atd_1,atd_2,atd_3]);%substituting all values

M_block= [(74035846717714448602402988169363*cos(conj(theta3)))/822752278660603021077484591278675252491367932816789931674304512 + cos(theta2)*(36*cos(theta2) + cos(theta3)*(24*cos(theta2) + 32*cos(theta2)*cos(theta3) - 32*sin(theta2)*sin(theta3)) + 24*cos(theta2)*cos(theta3) - 24*sin(theta2)*sin(theta3)) + (14903272800064533*cos(conj(theta3))*((14903272800064533*cos(conj(theta3)))/40564819207303340847894502572032 + 4967757600021511/10141204801825835211973625643008))/81129638414606681695789005144064 + (222107540153143345807208964508089*sin(conj(theta3))^2)/3291009114642412084309938365114701009965471731267159726697218048 - sin(theta2)*sin(theta3)*(24*cos(theta2) + 32*cos(theta2)*cos(theta3) - 32*sin(theta2)*sin(theta3)) + 616965389314287071686691568078025/3291009114642412084309938365114701009965471731267159726697218048, (14903272800064533*cos(conj(theta3)))/10141204801825835211973625643008 + (14903272800064533*cos(conj(theta3))*(6*cos(conj(theta3)) + 8))/81129638414606681695789005144064 + (44709818400193599*sin(conj(theta3))^2)/40564819207303340847894502572032 + 124193940000537775/40564819207303340847894502572032, (14903272800064533*cos(conj(theta3)))/10141204801825835211973625643008 + 4967757600021511/2535301200456458802993406410752;(14903272800064533*cos(conj(theta3)))/10141204801825835211973625643008 + 3*cos(conj(theta3))*((14903272800064533*cos(conj(theta3)))/40564819207303340847894502572032 + 4967757600021511/10141204801825835211973625643008) + (44709818400193599*sin(conj(theta3))^2)/40564819207303340847894502572032 + 124193940000537775/40564819207303340847894502572032,24*cos(conj(theta3)) + 3*cos(conj(theta3))*(6*cos(conj(theta3)) + 8) + 18*sin(conj(theta3))^2 + 50,24*cos(conj(theta3)) + 32;(14903272800064533*cos(conj(theta3)))/10141204801825835211973625643008 + 4967757600021511/2535301200456458802993406410752,24*cos(conj(theta3)) + 32,32];

Mblock_t = subs(M_block,[theta1,theta2,theta3],[at_1,at_2,at_3]);


%Error correction
Edot1 = THD - Atdot_output;
Etheta1 = TH - Atheta_output;
Torque_dash = kv*Edot1 + kp*Etheta1 + THDD; %Torque dash
torque = Torque_dash*Mblock_t + Vblock_t %Torque


%Forward dynamics

Minv = inv(Mblock_t); %M_inverse
eq_part=torque-Vblock_t;
accelaration=eq_part*Minv %Acceleration
ac1=accelaration(1);
acc_1_ans=vpa(subs(ac1,t,z)); %Acceleration for joint 1
ac2=accelaration(2);
acc_2_ans=vpa(subs(ac2,t,z)); %Acceleration for joint 2
ac3=accelaration(2);
acc_3_ans=vpa(subs(ac3,t,z)); %Acceleration for joint 3

%Velocity and position
vel=int(accelaration,t);
vel_ans=vpa(subs(vel(1,1),t,z))
pos=int(vel,t);
pos_ans=vpa(subs(pos(1,1),t,z))
torqueans1=vpa(subs(torque(1,1),t,z)); %Torques
torqueans2=vpa(subs(torque(1,2),t,z));
torqueans3=vpa(subs(torque(1,3),t,z));


%Plotting graphs

%Plotting Acceleration
figure(1)
Thdd1_final=vpa(subs(Thdd_1,t,z));
plot(z,Thdd1_final)
hold on
plot(z,acc_1_ans)
title('given acceleration vs tracked')
legend('Given acceleration','Tracked Acceleration')
hold off

%Velocity plotting
figure(2)
Thd1_final=vpa(subs(Thd_1,t,z));
plot(z,Thd1_final)
hold on
plot(z,vel_ans)
title('given velocity vs tracked velocity')
legend('Given velocity','Tracked Velocity')
hold off

%Position plotting
figure(3)
Th1_final=vpa(subs(Th_1,t,z));
plot(z,Th1_final)
hold on
plot(z,pos_ans)
title('Given position vs Tracked position')
legend('Given position','Tracked Position')
hold off

%Plotting torques
figure(4);
plot(z,Torque1_ans,'g');
title('Torque 1')
hold on
plot(z,torqueans1,'r');
legend('Given torque', 'Tracked Torque')
hold off
figure(5);
plot(z,Torque2_ans,'r');
title('Torque 2')
hold on
plot(z,torqueans2,'b');
legend('Given torque', 'Tracked Torque')
hold off
figure(6);
plot(z,Torque3_ans,'r');
title('Torque 3')
hold on
plot(z,torqueans3,'b');
legend('Given torque', 'Tracked Torque')
hold off